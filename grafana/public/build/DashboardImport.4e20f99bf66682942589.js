(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{Wkk1:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("q1tI"),a=r.n(n),o=r("kDLi"),i=r("Csm0");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=l(this,s(t).call(this,e))).onChange=function(e){var t=r.props.datasources.find((function(t){return t.name===e.value}));t&&r.props.onChange(t)},r}var r,n,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.datasources,r=e.current,n=e.autoFocus,u=e.hideTextValue,c=e.onBlur,l=e.openMenuOnFocus,s=e.showLoading,d=e.placeholder,f=e.invalid,p=t.map((function(e){return{value:e.name,label:e.name,imgUrl:e.meta.info.logos.small}})),m=r&&{label:r.name.substr(0,37),value:r.name,imgUrl:r.meta.info.logos.small,loading:s,hideText:u};return a.a.createElement("div",{"aria-label":i.selectors.components.DataSourcePicker.container},a.a.createElement(o.Select,{className:"ds-picker select-container",isMulti:!1,isClearable:!1,backspaceRemovesValue:!1,onChange:this.onChange,options:p,autoFocus:n,onBlur:c,openMenuOnFocus:l,maxMenuHeight:500,menuPlacement:"bottom",placeholder:d,noOptionsMessage:"No datasources found",value:m,invalid:f}))}}])&&c(r.prototype,n),u&&c(r,u),t}(n.PureComponent);f.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select datasource"},t.b=f},gzYa:function(e,t,r){"use strict";r.r(t);var n=r("q1tI"),a=r.n(n),o=r("kDDq"),i=r("Obii"),u=r("kDLi"),c=r("ZGyg"),l=r("hBny"),s=r("/MKj"),d=r("fL47"),f=r("Wkk1"),p=r("d4Ek"),m=r("t8hP"),b=function(e){try{return JSON.parse(e),!0}catch(e){return"Not valid JSON"}},h=function(e){var t=/(^\d+$)|dashboards\/(\d+)/.exec(e);return!(!t||!t[1]&&!t[2])||"Could not find a valid Grafana.com id"},y=function(e){return Object(m.getBackendSrv)().get("/api/dashboards/uid/".concat(e)).then((function(e){return"Dashboard named '".concat(null==e?void 0:e.dashboard.title,"' in folder '").concat(null==e?void 0:e.meta.folderTitle,"' has the same uid")})).catch((function(e){return e.isHandled=!0,!0}))};function v(e,t,r,n,a,o,i){try{var u=e[o](i),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,a)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){v(o,n,a,i,u,"next",e)}function u(e){v(o,n,a,i,u,"throw",e)}i(void 0)}))}}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var E=function(e){var t,r,o,i=e.register,c=e.errors,l=e.control,s=e.getValues,m=e.uidReset,b=e.inputs,h=e.initialFolderId,v=e.onUidReset,E=e.onCancel,j=e.onSubmit,S=O(Object(n.useState)(!1),2),D=S[0],F=S[1];return Object(n.useEffect)((function(){D&&(c.title||c.uid)&&j(s({nest:!0}),{})}),[c]),a.a.createElement(a.a.Fragment,null,a.a.createElement(u.Legend,null,"Options"),a.a.createElement(u.Field,{label:"Name",invalid:!!c.title,error:c.title&&c.title.message},a.a.createElement(u.Input,{name:"title",type:"text",ref:i({required:"Name is required",validate:(o=g(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r=t,n=s().folder.id,p.a.validateNewDashboardName(n,r).then((function(){return!0})).catch((function(e){if("EXISTING"===e.type)return e.message}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}var r,n}),e)}))),function(e){return o.apply(this,arguments)})})})),a.a.createElement(u.Field,{label:"Folder"},a.a.createElement(u.InputControl,{as:d.a,name:"folder",useNewForms:!0,enableCreateNew:!0,initialFolderId:h,control:l})),a.a.createElement(u.Field,{label:"Unique identifier (uid)",description:"The unique identifier (uid) of a dashboard can be used for uniquely identify a dashboard between multiple Grafana installs. The uid allows having consistent URLâ€™s for accessing dashboards so changing the title of a dashboard will not break any bookmarked links to that dashboard.",invalid:!!c.uid,error:c.uid&&c.uid.message},a.a.createElement(a.a.Fragment,null,m?a.a.createElement(u.Input,{name:"uid",ref:i({required:!0,validate:(t=g(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})})}):a.a.createElement(u.Input,{name:"uid",disabled:!0,ref:i({validate:(r=g(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}),addonAfter:!m&&a.a.createElement(u.Button,{onClick:v},"Change uid")}))),b.dataSources&&b.dataSources.map((function(e,t){var r="dataSources[".concat(t,"]");return a.a.createElement(u.Field,{label:e.label,key:r,invalid:c.dataSources&&!!c.dataSources[t],error:c.dataSources&&c.dataSources[t]&&"A data source is required"},a.a.createElement(u.InputControl,{as:f.b,name:"".concat(r),datasources:e.options,control:l,placeholder:e.info,rules:{required:!0}}))})),b.constants&&b.constants.map((function(e,t){var r="constants[".concat(t,"]");return a.a.createElement(u.Field,{label:e.label,error:c.constants&&c.constants[t]&&"".concat(e.label," needs a value"),invalid:c.constants&&!!c.constants[t],key:r},a.a.createElement(u.Input,{ref:i({required:!0}),name:"".concat(r),defaultValue:e.value}))})),a.a.createElement(u.HorizontalGroup,null,a.a.createElement(u.Button,{type:"submit",variant:w(c),onClick:function(){F(!0)}},function(e){return e&&(e.title||e.uid)?"Import (Overwrite)":"Import"}(c)),a.a.createElement(u.Button,{type:"reset",variant:"secondary",onClick:E},"Cancel")))};function w(e){return e&&(e.title||e.uid)?"destructive":"primary"}var j=r("5LyR"),S=r("nFP0");function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R=function(e){function t(){var e,r;I(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=N(this,(e=x(t)).call.apply(e,[this].concat(a)))).state={uidReset:!1},r.onSubmit=function(e){r.props.importDashboard(e)},r.onCancel=function(){r.props.clearLoadedDashboard()},r.onUidReset=function(){r.setState({uidReset:!0})},r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this,t=this.props,r=t.dashboard,n=t.inputs,o=t.meta,c=t.source,l=t.folder,s=this.state.uidReset;return a.a.createElement(a.a.Fragment,null,c===S.a.Gcom&&a.a.createElement("div",{style:{marginBottom:"24px"}},a.a.createElement("div",null,a.a.createElement(u.Legend,null,"Importing Dashboard from"," ",a.a.createElement("a",{href:"https://grafana.com/dashboards/".concat(r.gnetId),className:"external-link",target:"_blank"},"Grafana.com"))),a.a.createElement("table",{className:"filter-table form-inline"},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null,"Published by"),a.a.createElement("td",null,o.orgName)),a.a.createElement("tr",null,a.a.createElement("td",null,"Updated on"),a.a.createElement("td",null,Object(i.dateTimeFormat)(o.updatedAt)))))),a.a.createElement(u.Form,{onSubmit:this.onSubmit,defaultValues:P({},r,{constants:[],dataSources:[],folder:l}),validateOnMount:!0,validateFieldsOnMount:["title","uid"],validateOn:"onChange"},(function(t){var r=t.register,o=t.errors,i=t.control,u=t.getValues;return a.a.createElement(E,{register:r,errors:o,control:i,getValues:u,uidReset:s,inputs:n,onCancel:e.onCancel,onUidReset:e.onUidReset,onSubmit:e.onSubmit,initialFolderId:l.id})})))}}])&&C(r.prototype,n),o&&C(r,o),t}(n.PureComponent),J={clearLoadedDashboard:j.a,importDashboard:j.f},T=Object(s.connect)((function(e){return{dashboard:e.importDashboard.dashboard,meta:e.importDashboard.meta,source:e.importDashboard.source,inputs:e.importDashboard.inputs,folder:e.location.routeParams.folderId?{id:Number(e.location.routeParams.folderId)}:{id:0}}}),J)(R);T.displayName="ImportDashboardOverview";var q=r("Xmxp"),L=r("lzJ5");function U(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n      margin-bottom: 32px;\n    "]);return U=function(){return e},e}function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r.d(t,"DashboardImportPage",(function(){return K}));var H=function(e){function t(){var e,r;G(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=B(this,(e=V(t)).call.apply(e,[this].concat(a)))).onFileUpload=function(e){var t=r.props.importDashboardJson,n=e.currentTarget.files&&e.currentTarget.files.length>0&&e.currentTarget.files[0];if(n){var a=new FileReader;a.onload=function(e){var r;try{r=JSON.parse(e.target.result)}catch(e){return void q.b.emit(i.AppEvents.alertError,["Import failed","JSON -> JS Serialization failed: "+e.message])}t(r)},a.readAsText(n)}},r.getDashboardFromJson=function(e){r.props.importDashboardJson(JSON.parse(e.dashboardJson))},r.getGcomDashboard=function(e){var t,n=/(^\d+$)|dashboards\/(\d+)/.exec(e.gcomDashboard);n&&n[1]?t=n[1]:n&&n[2]&&(t=n[2]),t&&r.props.fetchGcomDashboard(t)},r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,e),r=t,(n=[{key:"renderImportForm",value:function(){var e=X();return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:e.option},a.a.createElement(u.FileUpload,{accept:"application/json",onFileUpload:this.onFileUpload},"Upload JSON file")),a.a.createElement("div",{className:e.option},a.a.createElement(u.Legend,null,"Import via grafana.com"),a.a.createElement(u.Form,{onSubmit:this.getGcomDashboard,defaultValues:{gcomDashboard:""}},(function(e){var t=e.register,r=e.errors;return a.a.createElement(u.Field,{invalid:!!r.gcomDashboard,error:r.gcomDashboard&&r.gcomDashboard.message},a.a.createElement(u.Input,{name:"gcomDashboard",placeholder:"Grafana.com dashboard url or id",type:"text",ref:t({required:"A Grafana dashboard url or id is required",validate:h}),addonAfter:a.a.createElement(u.Button,{type:"submit"},"Load")}))}))),a.a.createElement("div",{className:e.option},a.a.createElement(u.Legend,null,"Import via panel json"),a.a.createElement(u.Form,{onSubmit:this.getDashboardFromJson,defaultValues:{dashboardJson:""}},(function(e){var t=e.register,r=e.errors;return a.a.createElement(a.a.Fragment,null,a.a.createElement(u.Field,{invalid:!!r.dashboardJson,error:r.dashboardJson&&r.dashboardJson.message},a.a.createElement(u.TextArea,{name:"dashboardJson",ref:t({required:"Need a dashboard json model",validate:b}),rows:10})),a.a.createElement(u.Button,{type:"submit"},"Load"))}))))}},{key:"render",value:function(){var e=this.props,t=e.isLoaded,r=e.navModel;return a.a.createElement(c.a,{navModel:r},a.a.createElement(c.a.Contents,null,t?a.a.createElement(T,null):this.renderImportForm()))}}])&&M(r.prototype,n),o&&M(r,o),t}(n.PureComponent),W={fetchGcomDashboard:j.e,importDashboardJson:j.g},K=Object(l.a)((function(e){return{navModel:Object(L.a)(e.navIndex,"import",void 0,!0),isLoaded:e.importDashboard.isLoaded}}),W,(function(e){return e.importDashboard}))(H);t.default=K;K.displayName="DashboardImport";var X=Object(u.stylesFactory)((function(){return{option:Object(o.css)(U())}}))},hBny:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("/MKj"),a=r("zVNn"),o=r("q1tI"),i=r.n(o),u=r("2mql"),c=r.n(u),l=function(e,t,r){return function(u){var l=Object(n.connect)(e,t)(u),s=function(e){var t=Object(n.useDispatch)();return Object(o.useEffect)((function(){return function(){t(Object(a.a)({stateSelector:r}))}}),[]),i.a.createElement(l,e)};return s.displayName="ConnectWithCleanUp(".concat(l.displayName,")"),c()(s,u),s}}}}]);
//# sourceMappingURL=DashboardImport.4e20f99bf66682942589.js.map