(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{EaOu:function(e,t,r){"use strict";r.r(t);var n=r("Obii"),a=r("BkRI"),o=r.n(a),i=r("F/XL"),u=r("p0ib"),s=r("VNr4"),l=r("XlPw"),c=r("xMyE"),f=r("VnD/"),p=r("67Y/"),m=r("9Z1F"),h=r("LvDl"),d=r.n(h),v=r("NPB1");function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var g=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.datasource=t,this.query=r,this.datasource=t,this.query=r,this.range=Object(v.a)().timeRange()}var t,r,n;return t=e,(r=[{key:"process",value:function(){if(this.query.match(/^label_names\(\)\s*$/))return this.labelNamesQuery();var e=this.query.match(/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/);if(e)return e[1]?this.labelValuesQuery(e[2],e[1]):this.labelValuesQuery(e[2]);var t=this.query.match(/^metrics\((.+)\)\s*$/);if(t)return this.metricNameQuery(t[1]);var r=this.query.match(/^query_result\((.+)\)\s*$/);return r?this.queryResultQuery(r[1]).toPromise():this.metricNameAndLabelsQuery(this.query)}},{key:"labelNamesQuery",value:function(){return this.datasource.metadataRequest("/api/v1/labels").then((function(e){return d.a.map(e.data.data,(function(e){return{text:e}}))}))}},{key:"labelValuesQuery",value:function(e,t){var r;if(t){var n=this.datasource.getPrometheusTime(this.range.from,!1),a=this.datasource.getPrometheusTime(this.range.to,!0),o=new URLSearchParams({"match[]":t,start:n.toString(),end:a.toString()});return r="/api/v1/series?".concat(o.toString()),this.datasource.metadataRequest(r).then((function(t){var r=d.a.map(t.data.data,(function(t){return t[e]||""})).filter((function(e){return""!==e}));return d.a.uniq(r).map((function(e){return{text:e,expandable:!0}}))}))}return r="/api/v1/label/"+e+"/values",this.datasource.metadataRequest(r).then((function(e){return d.a.map(e.data.data,(function(e){return{text:e}}))}))}},{key:"metricNameQuery",value:function(e){return this.datasource.metadataRequest("/api/v1/label/__name__/values").then((function(t){return d.a.chain(t.data.data).filter((function(t){return new RegExp(e).test(t)})).map((function(e){return{text:e,expandable:!0}})).value()}))}},{key:"queryResultQuery",value:function(e){var t=this.datasource.getPrometheusTime(this.range.to,!0),r={expr:e};return this.datasource.performInstantQuery(r,t).pipe(Object(p.a)((function(e){return d.a.map(e.data.data.result,(function(e){var t=e.metric.__name__||"";return delete e.metric.__name__,t+="{"+d.a.map(e.metric,(function(e,t){return t+'="'+e+'"'})).join(",")+"}",{text:t+=" "+e.value[1]+" "+1e3*e.value[0],expandable:!0}}))})))}},{key:"metricNameAndLabelsQuery",value:function(e){var t=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),n=new URLSearchParams({"match[]":e,start:t.toString(),end:r.toString()}),a="/api/v1/series?".concat(n.toString()),o=this;return this.datasource.metadataRequest(a).then((function(e){return d.a.map(e.data.data,(function(e){return{text:o.datasource.getOriginalMetricName(e),expandable:!0}}))}))}}])&&y(t.prototype,r),n&&y(t,n),e}(),b=r("iZOS");function O(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.templateSrv=t}var t,r,a;return t=e,(r=[{key:"transform",value:function(e,t){var r=e.data.data.result;if("table"===t.format)return[this.transformMetricDataToTable(r,t.responseListLength,t.refId,t.meta,t.valueWithRefId)];if(r&&"heatmap"===t.format){var n=[],a=!0,o=!1,i=void 0;try{for(var u,s=r[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value;n.push(this.transformMetricData(l,t,t.start,t.end))}}catch(e){o=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}return n.sort(j),n=this.transformToHistogramOverTime(n)}if(r){var c=[],f=!0,p=!1,m=void 0;try{for(var h,d=r[Symbol.iterator]();!(f=(h=d.next()).done);f=!0){var v=h.value;"matrix"===e.data.data.resultType?c.push(this.transformMetricData(v,t,t.start,t.end)):"vector"===e.data.data.resultType&&c.push(this.transformInstantMetricData(v,t))}}catch(e){p=!0,m=e}finally{try{f||null==d.return||d.return()}finally{if(p)throw m}}return c}return[]}},{key:"transformMetricData",value:function(e,t,r,n){var a=[],o=this.createLabelInfo(e.metric,t),i=o.name,u=o.labels,s=o.title,l=1e3*parseFloat(t.step),c=1e3*r;if(void 0===e.values)throw new Error("Prometheus heatmap error: data should be a time series");var f=!0,p=!1,m=void 0;try{for(var h,v=e.values[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var y=h.value,g=parseFloat(y[1]);d.a.isNaN(g)&&(g=null);for(var b=1e3*parseFloat(y[0]),O=c;O<b;O+=l)a.push([null,O]);c=b+l,a.push([g,b])}}catch(e){p=!0,m=e}finally{try{f||null==v.return||v.return()}finally{if(p)throw m}}for(var w=1e3*n,x=c;x<=w;x+=l)a.push([null,x]);return{datapoints:a,refId:t.refId,target:null!=i?i:"",tags:u,title:s,meta:t.meta}}},{key:"transformMetricDataToTable",value:function(e,t,r,a,o){var i,u,s=new b.a;s.refId=r,s.meta=a;var l={};if(!e||0===e.length)return s;d.a.each(e,(function(e){for(var t in e.metric)l.hasOwnProperty(t)||(l[t]=1)}));var c=d.a.keys(l).sort();s.columns.push({text:"Time",type:n.FieldType.time}),d.a.each(c,(function(e,t){l[e]=t+1,s.columns.push({text:e,filterable:!0})}));var f=t>1||o?"Value #".concat(r):"Value";return s.columns.push({text:f}),d.a.each(e,(function(e){if(e.value&&(e.values=[e.value]),e.values)for(i=0;i<e.values.length;i++){var t=e.values[i],r=[1e3*t[0]];if(e.metric)for(u=0;u<c.length;u++){var n=c[u];e.metric.hasOwnProperty(n)?"le"===n?r.push(k(e.metric[n])):r.push(e.metric[n]):r.push("")}r.push(parseFloat(t[1])),s.rows.push(r)}})),s}},{key:"transformInstantMetricData",value:function(e,t){var r=[],n=this.createLabelInfo(e.metric,t),a=n.name,o=n.labels;return r.push([parseFloat(e.value[1]),1e3*e.value[0]]),{target:null!=a?a:"",title:a,datapoints:r,tags:o,refId:t.refId,meta:t.meta}}},{key:"createLabelInfo",value:function(e,t){if(null==t?void 0:t.legendFormat){var r=this.renderTemplate(this.templateSrv.replace(t.legendFormat,null==t?void 0:t.scopedVars),e);return{name:r,title:r,labels:e}}var a=e.__name__,o=O(e,["__name__"]),i=a||"",u=Object(n.formatLabels)(o);return i||u||(i=t.query),{name:i="".concat(null!=a?a:"").concat(u),title:i,labels:o}}},{key:"getOriginalMetricName",value:function(e){var t=e.__name__||"";delete e.__name__;var r=Object.entries(e).map((function(e){return"".concat(e[0],'="').concat(e[1],'"')})).join(",");return"".concat(t,"{").concat(r,"}")}},{key:"renderTemplate",value:function(e,t){return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(function(e,r){return t[r]?t[r]:""}))}},{key:"transformToHistogramOverTime",value:function(e){for(var t=e.length-1;t>0;t--){var r=e[t].datapoints,n=e[t-1].datapoints;if(!r||!n)throw new Error("Prometheus heatmap transform error: data should be a time series");for(var a=0;a<r.length;a++){var o=n[a]||[0];r[a][0]-=o[0]}}return e}}])&&w(t.prototype,r),a&&w(t,a),e}();function j(e,t){var r,n;try{r=k(e.target),n=k(t.target)}catch(e){return console.error(e),0}return r>n?1:r<n?-1:0}function k(e){return"+Inf"===e?1/0:Number(e)}var P=r("HyWp"),_=r.n(P),E=r("ceQ3"),T=r("itod");function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function C(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function q(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){C(o,n,a,i,u,"next",e)}function u(e){C(o,n,a,i,u,"throw",e)}i(void 0)}))}}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var N=["job","instance"],U=function(e){return{label:e}},V=function(e){return e.kind="function",e};var H=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,B=function(e){function t(e,r){var a,o,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=I(t).call(this),(a=!i||"object"!==S(i)&&"function"!=typeof i?M(o):i).labelsCache=new _.a(10),a.request=function(){var e=q(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.datasource.metadataRequest(t);case 3:return n=e.sent,e.abrupt("return",n.data.data);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),a.start=q(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.datasource.lookupsDisabled){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,a.request("/api/v1/label/__name__/values",[]);case 4:return a.metrics=e.sent,a.lookupsDisabled=a.metrics.length>a.lookupMetricsThreshold,e.t0=E.b,e.next=9,a.request("/api/v1/metadata",{});case 9:return e.t1=e.sent,a.metricsMetadata=(0,e.t0)(e.t1),a.processHistogramMetrics(a.metrics),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)}))),a.processHistogramMetrics=function(e){var t=Object(E.e)(e).values;t&&t.__name__&&(a.histogramMetrics=t.__name__.slice().sort())},a.provideCompletionItems=function(){var e=q(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,l,c,f,p,m,h,d,v,y,g,b,O=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.prefix,n=t.text,o=t.value,i=t.labelKey,u=t.wrapperClasses,s=O.length>1&&void 0!==O[1]?O[1]:{history:[]},l={suggestions:[]},o){e.next=5;break}return e.abrupt("return",l);case 5:if(c=0===o.document.text.length,f=o.document.getTextsAtRange(o.selection),p=1===f.size?f.first().getText():null,m=p?p[o.selection.anchor.offset]:null,h=u.length>3,d=r&&!h,v=!m||")"===m,y=r&&!n.match(/^[\]})\s]+$/)&&v,g=/[+\-*/^%]/,b=n.match(g),!u.includes("context-range")){e.next=19;break}return e.abrupt("return",a.getRangeCompletionItems());case 19:if(!u.includes("context-labels")){e.next=23;break}return e.abrupt("return",a.getLabelCompletionItems({prefix:r,text:n,value:o,labelKey:i,wrapperClasses:u}));case 23:if(!u.includes("context-aggregation")){e.next=27;break}return e.abrupt("return",a.getAggregationCompletionItems(o));case 27:if(!c){e.next=31;break}return e.abrupt("return",a.getEmptyCompletionItems(s));case 31:if(!d||!v||b){e.next=35;break}return e.abrupt("return",a.getBeginningCompletionItems(s));case 35:if(!d||!y){e.next=37;break}return e.abrupt("return",a.getTermCompletionItems());case 37:return e.abrupt("return",l);case 38:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getBeginningCompletionItems=function(e){return{suggestions:[].concat(R(a.getEmptyCompletionItems(e).suggestions),R(a.getTermCompletionItems().suggestions))}},a.getEmptyCompletionItems=function(e){var t=e.history,r=[];if(t&&t.length){var a=d.a.chain(t).map((function(e){return e.query.expr})).filter().uniq().take(5).map(U).map((function(e){return function(e,t){var r=Date.now()-864e5,a=t.filter((function(t){return t.ts>r&&t.query===e.label})),o=a.length,i=a[0],u="Queried ".concat(o," times in the last 24h.");if(i){var s=Object(n.dateTime)(i.ts).fromNow();u="".concat(u," Last queried ").concat(s,".")}return F({},e,{documentation:u})}(e,t)})).value();r.push({prefixMatch:!0,skipSort:!0,label:"History",items:a})}return{suggestions:r}},a.getTermCompletionItems=function(){var e=M(a),t=e.metrics,r=e.metricsMetadata,n=[];return n.push({prefixMatch:!0,label:"Functions",items:T.a.map(V)}),t&&t.length&&n.push({label:"Metrics",items:t.map((function(e){return function(e,t){var r={label:e};if(t&&t[e]){var n=t[e][0],a=n.type,o=n.help;r.documentation="".concat(a.toUpperCase(),": ").concat(o)}return r}(e,r)}))}),{suggestions:n}},a.getAggregationCompletionItems=function(){var e=q(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,l,c,f,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],o=t.document.getBlocks().reduce((function(e,r){if(!r)return e;var a=null==r?void 0:r.getText();return t.anchorBlock.key===r.key&&(n=t.selection.anchor.offset+e.length),e+a}),""),i=o.lastIndexOf("(",n),u=o.lastIndexOf("(",i-1),s=o.indexOf(")",u),-1===u&&(l=o.indexOf(")",n),s=o.indexOf(")",l+1),u=o.lastIndexOf("(",s)),c={suggestions:r,context:"context-aggregation"},-1!==u){e.next=9;break}return e.abrupt("return",c);case 9:return f=o.slice(u+1,s).replace(/\[[^\]]+\]$/,""),p=Object(E.d)(f,f.length-2).selector,e.next=13,a.getLabelValues(p);case 13:return(m=e.sent)&&r.push({label:"Labels",items:Object.keys(m).map(U)}),e.abrupt("return",c);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getLabelCompletionItems=function(){var e=q(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,l,c,f,p,m,h,v,y,g,b,O,w,x,j,k,P,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.text,n=t.wrapperClasses,o=t.labelKey,i=t.value){e.next=3;break}return e.abrupt("return",{suggestions:[]});case 3:if(u=[],s=i.anchorBlock.getText(),l=i.selection.anchor.offset,c=s.substr(l),f=s.substr(0,l),p=r.match(/^(=|=~|!=|!~)/),m=c.match(/^"?[,}]/),h=f.match(/(=|=~|!=|!~)$/)&&c.match(/^"/),v=m&&!p,(p&&m||v)&&!h){e.next=15;break}return e.abrupt("return",{suggestions:u});case 15:try{g=Object(E.d)(s,l),y=g.selector}catch(e){y="{}"}if(b=y.includes("__name__="),O=g?g.labelKeys:[],!y){e.next=22;break}return e.next=21,a.getLabelValues(y,!b);case 21:w=e.sent;case 22:if(w){e.next=25;break}return console.warn("Server did not return any values for selector = ".concat(y)),e.abrupt("return",{suggestions:u});case 25:return r&&p||n.includes("attr-value")?o&&w[o]&&(x="context-label-values",u.push({label:'Label values for "'.concat(o,'"'),items:w[o].map(U)})):(j=w?Object.keys(w):b?null:N)&&(k=d.a.difference(j,O)).length&&(x="context-labels",P=k.map((function(e){return{label:e}})),_={label:"Labels",items:P},u.push(_)),e.abrupt("return",{context:x,suggestions:u});case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.fetchLabelValues=function(){var e=q(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.request("/api/v1/label/".concat(t,"/values"),[]);case 2:return r=e.sent,e.abrupt("return",A({},t,r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.fetchSeriesLabels=function(){var e=q(regeneratorRuntime.mark((function e(t,r){var n,o,i,u,s,l,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.datasource.getTimeRange(),o=new URLSearchParams({"match[]":t,start:n.start.toString(),end:n.end.toString()}),i="/api/v1/series?".concat(o.toString()),o.set("start",a.roundToMinutes(n.start).toString()),o.set("end",a.roundToMinutes(n.end).toString()),o.append("withName",r?"true":"false"),u="/api/v1/series?".concat(o.toString()),s=a.labelsCache.get(u)){e.next=15;break}return e.next=11,a.request(i,[]);case 11:l=e.sent,c=Object(E.f)(l,r),f=c.values,s=f,a.labelsCache.set(u,s);case 15:return e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),a.fetchDefaultLabels=d.a.once(q(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(N.map((function(e){return a.fetchLabelValues(e)})));case 2:return t=e.sent,e.abrupt("return",t.reduce((function(e,t){return F({},e,{},t)}),{}));case 4:case"end":return e.stop()}}),e)})))),a.datasource=e,a.histogramMetrics=[],a.timeRange={start:0,end:0},a.metrics=[],a.lookupMetricsThreshold=1e4,a.lookupsDisabled=!0,Object.assign(M(a),r),a}var r,a,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,e),r=t,(a=[{key:"cleanText",value:function(e){return e.split(H).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}},{key:"getRangeCompletionItems",value:function(){return{context:"context-range",suggestions:[{label:"Range vector",items:R(T.b)}]}}},{key:"getLabelValues",value:(i=q(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.lookupsDisabled){e.next=2;break}return e.abrupt("return",void 0);case 2:if(e.prev=2,"{}"!==t){e.next=9;break}return e.next=6,this.fetchDefaultLabels();case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,this.fetchSeriesLabels(t,r);case 11:return e.abrupt("return",e.sent);case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this,[[2,14]])}))),function(e,t){return i.apply(this,arguments)})},{key:"roundToMinutes",value:function(e){return Math.floor(e/60)}},{key:"syntax",get:function(){return T.c}}])&&D(r.prototype,a),o&&D(r,o),t}(n.LanguageProvider),$=r("t8hP"),G=r("eqT+");function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z(e,t,r){var n=[];if(e.trim().match(/^\w+_bucket$/)){n.push({type:"HISTOGRAM_QUANTILE",label:"Time series has buckets, you probably wanted a histogram.",fix:{label:"Fix by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:e}}})}if(-1===e.indexOf("rate(")&&-1===e.indexOf("increase(")){var a,o,i,u=e.match(/\b(\w+_(total|sum|count))\b/),s=u?u[1]:"",l=null!==(a=null==r?void 0:null===(o=r.languageProvider)||void 0===o?void 0:o.metricsMetadata)&&void 0!==a?a:{},c=Object.keys(l),f=!1;if(c.length>0)s=null!==(i=c.find((function(t){if("counter"===l[t][0].type.toLowerCase()){var r=new RegExp("\\b".concat(t,"\\b"));if(e.match(r))return f=!0,!0}return!1})))&&void 0!==i?i:"";if(s){var p,m=e.trim().match(/^\w+$/),h=f?"is":"looks like",v="Metric ".concat(s," ").concat(h," a counter.");m?p={label:"Fix by adding rate().",action:{type:"ADD_RATE",query:e}}:v="".concat(v," Try applying a rate() function."),n.push({type:"APPLY_RATE",label:v,fix:p})}}if(r&&r.ruleMappings){var y=r.ruleMappings,g=Object.keys(y).reduce((function(t,r){return e.search(r)>-1?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,W({},r,y[r])):t}),{});if(d.a.size(g)>0){n.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:e,mapping:g}}})}}t&&t.length>=20&&(e.trim().match(/^\w+$/)&&n.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:e,preventSubmit:!0}}}));return n}var X=r("m257"),Y=r("5kRJ");function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function ee(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Z(o,n,a,i,u,"next",e)}function u(e){Z(o,n,a,i,u,"throw",e)}i(void 0)}))}}function te(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce=function(e){function t(e){var r,a,i,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,u=ue(t).call(this,e),(a=!u||"object"!==J(u)&&"function"!=typeof u?se(i):u).init=function(){a.loadRules()},a.processResult=function(e,t,r,n,o){var i={format:r.format,step:t.step,legendFormat:r.legendFormat,start:t.start,end:t.end,query:t.expr,responseListLength:n,scopedVars:o,refId:r.refId,valueWithRefId:r.valueWithRefId,meta:{preferredVisualisationType:t.instant?"table":"graph"}};return a.resultTransformer.transform(e,i)},a.prepareTargets=function(e,t,r){var i=[],u=[],s=!0,l=!1,c=void 0;try{for(var f,p=e.targets[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;if(m.expr&&!m.hide)if(m.requestId=e.panelId+m.refId,e.app===n.CoreApp.Explore){if(e.showingTable){var h=o()(m);h.format="table",h.instant=!0,h.valueWithRefId=!0,delete h.maxDataPoints,h.requestId+="_instant",u.push(h),i.push(a.createQuery(h,e,t,r))}e.showingGraph&&(m.format="time_series",m.instant=!1,u.push(m),i.push(a.createQuery(m,e,t,r)))}else u.push(m),i.push(a.createQuery(m,e,t,r))}}catch(e){l=!0,c=e}finally{try{s||null==p.return||p.return()}finally{if(l)throw c}}return{queries:i,activeTargets:u}},a.handleErrors=function(e,t){var r={message:e&&e.statusText||"Unknown error during query transaction. Please check JS console logs.",refId:t.refId};return e.data?"string"==typeof e.data?r.message=e.data:e.data.error&&(r.message=Object(X.s)(e.data.error)):e.message?r.message=e.message:"string"==typeof e&&(r.message=e),r.status=e.status,r.statusText=e.statusText,r},a.createAnnotationQueryOptions=function(e){var t=e.annotation;return ae({},e,{interval:t&&t.step&&"string"==typeof t.step?t.step:"60s"})},a.type="prometheus",a.editorSrc="app/features/prometheus/partials/query.editor.html",a.url=e.url,a.basicAuth=e.basicAuth,a.withCredentials=e.withCredentials,a.interval=e.jsonData.timeInterval||"15s",a.queryTimeout=e.jsonData.queryTimeout,a.httpMethod=e.jsonData.httpMethod||"GET",a.directUrl=e.jsonData.directUrl,a.resultTransformer=new x(Y.a),a.ruleMappings={},a.languageProvider=new B(se(a)),a.lookupsDisabled=null!==(r=e.jsonData.disableMetricsLookup)&&void 0!==r&&r,a.customQueryParameters=new URLSearchParams(e.jsonData.customQueryParameters),a}var r,a,d,y,b,O,w,j,k;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,e),r=t,(a=[{key:"getQueryDisplayText",value:function(e){return e.expr}},{key:"_addTracingHeaders",value:function(e,t){e.headers={},!this.url.match(/^http/)&&(e.headers["X-Dashboard-Id"]=t.dashboardId,e.headers["X-Panel-Id"]=t.panelId)}},{key:"_request",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object(h.defaults)(r,{url:this.url+e,method:this.httpMethod,headers:{}});return"GET"===n.method?t&&Object.keys(t).length&&(n.url=n.url+"?"+Object.entries(t).map((function(e){var t=re(e,2),r=t[0],n=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(n))})).join("&")):(n.headers["Content-Type"]="application/x-www-form-urlencoded",n.data=t),(this.basicAuth||this.withCredentials)&&(n.withCredentials=!0),this.basicAuth&&(n.headers.Authorization=this.basicAuth),Object($.getBackendSrv)().fetch(n)}},{key:"metadataRequest",value:function(e){return this._request(e,null,{method:"GET",hideFromInspector:!0}).toPromise()}},{key:"interpolateQueryExpr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t.multi&&!t.includeAll)return pe(e);if("string"==typeof e)return me(e);var r=e.map((function(e){return me(e)}));return 1===r.length?r[0]:"("+r.join("|")+")"}},{key:"targetContainsTemplate",value:function(e){return Y.a.variableExists(e.expr)}},{key:"query",value:function(e){var t=this.getPrometheusTime(e.range.from,!1),r=this.getPrometheusTime(e.range.to,!0),a=this.prepareTargets(e,t,r),o=a.queries,u=a.activeTargets;return o&&o.length?e.app===n.CoreApp.Explore?this.exploreQuery(o,u,r):this.panelsQuery(o,u,r,e.requestId,e.scopedVars):Object(i.a)({data:[],state:n.LoadingState.Done})}},{key:"exploreQuery",value:function(e,t,r){var a=this,o=e.length,i=e.map((function(i,u){var s=t[u];return(i.instant?a.performInstantQuery(i,r):a.performTimeSeriesQuery(i,i.start,i.end)).pipe(Object(c.a)((function(){return o--})),Object(f.a)((function(e){return!e.cancelled})),Object(p.a)((function(t){return{data:a.processResult(t,i,s,e.length),key:i.requestId,state:0===o?n.LoadingState.Done:n.LoadingState.Loading}})))}));return u.a.apply(void 0,te(i))}},{key:"panelsQuery",value:function(e,t,r,a,o){var i=this,u=e.map((function(n,a){var u=t[a];return(n.instant?i.performInstantQuery(n,r):i.performTimeSeriesQuery(n,n.start,n.end)).pipe(Object(f.a)((function(e){return!e.cancelled})),Object(p.a)((function(t){return i.processResult(t,n,u,e.length,o)})))}));return Object(s.a)(u).pipe(Object(p.a)((function(e){return{data:e.reduce((function(e,t){return[].concat(te(e),te(t))}),[]),key:a,state:n.LoadingState.Done}})))}},{key:"createQuery",value:function(e,t,r,a){var o={hinting:e.hinting,instant:e.instant,step:0,expr:"",requestId:e.requestId,refId:e.refId,start:0,end:0},i=Math.ceil(a-r),u=n.rangeUtil.intervalToSeconds(t.interval),s=n.rangeUtil.intervalToSeconds(Y.a.replace(e.interval||t.interval,t.scopedVars)),l=e.interval?n.rangeUtil.intervalToSeconds(Y.a.replace(e.interval,t.scopedVars)):n.rangeUtil.intervalToSeconds(this.interval),c=e.intervalFactor||1,f=this.adjustInterval(u,s,i,c),p=ae({},t.scopedVars,{},this.getRangeScopedVars(t.range),{},this.getRateIntervalScopedVariable(f,l));u!==f&&(u=f,p=Object.assign({},t.scopedVars,ae({__interval:{text:u+"s",value:u+"s"},__interval_ms:{text:1e3*u,value:1e3*u}},this.getRateIntervalScopedVariable(u,l),{},this.getRangeScopedVars(t.range)))),o.step=u;var m=e.expr;m=Y.a.getAdhocFilters(this.name).reduce((function(e,t){var r=t.key,n=t.operator,a=t.value;return"=~"!==n&&"!~"!==n||(a=pe(a)),Object(G.b)(e,r,a,n)}),m),o.expr=Y.a.replace(m,p,this.interpolateQueryExpr);var h=function(e,t,r,n){var a=Math.floor((t+n)/r)*r-n,o=Math.floor((e+n)/r)*r-n;return{end:a,start:o}}(r,a,o.step,60*Object(v.a)().timeRange().to.utcOffset());return o.start=h.start,o.end=h.end,this._addTracingHeaders(o,t),o}},{key:"getRateIntervalScopedVariable",value:function(e,t){0===t&&(t=15);var r=Math.max(e+t,4*t);return{__rate_interval:{text:r+"s",value:r+"s"}}}},{key:"adjustInterval",value:function(e,t,r,n){var a=r/11e3;return a>1&&(a=Math.ceil(a)),Math.max(e*n,t,a)}},{key:"performTimeSeriesQuery",value:function(e,t,r){var n=this;if(t>r)throw{message:"Invalid time range"};var a={query:e.expr,start:t,end:r,step:e.step};this.queryTimeout&&(a.timeout=this.queryTimeout);var o=!0,u=!1,s=void 0;try{for(var c,f=this.customQueryParameters[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var p=re(c.value,2),h=p[0],d=p[1];null==a[h]&&(a[h]=d)}}catch(e){u=!0,s=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}return this._request("/api/v1/query_range",a,{requestId:e.requestId,headers:e.headers}).pipe(Object(m.a)((function(t){return t.cancelled?Object(i.a)(t):Object(l.a)(n.handleErrors(t,e))})))}},{key:"performInstantQuery",value:function(e,t){var r=this,n={query:e.expr,time:t};this.queryTimeout&&(n.timeout=this.queryTimeout);var a=!0,o=!1,u=void 0;try{for(var s,c=this.customQueryParameters[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=re(s.value,2),p=f[0],h=f[1];null==n[p]&&(n[p]=h)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return this._request("/api/v1/query",n,{requestId:e.requestId,headers:e.headers}).pipe(Object(m.a)((function(t){return t.cancelled?Object(i.a)(t):Object(l.a)(r.handleErrors(t,e))})))}},{key:"performSuggestQuery",value:(k=ee(regeneratorRuntime.mark((function e(t){var r,n,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length>1&&void 0!==a[1]&&a[1]&&(null===(r=this.metricsNameCache)||void 0===r?void 0:r.expire)>Date.now())){e.next=3;break}return e.abrupt("return",this.metricsNameCache.data.filter((function(e){return 1!==e.indexOf(t)})));case 3:return e.next=5,this.metadataRequest("/api/v1/label/__name__/values");case 5:return n=e.sent,this.metricsNameCache={data:n.data.data,expire:Date.now()+6e4},e.abrupt("return",n.data.data.filter((function(e){return 1!==e.indexOf(t)})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"metricFindQuery",value:function(e){if(!e)return Promise.resolve([]);var t=ae({__interval:{text:this.interval,value:this.interval},__interval_ms:{text:n.rangeUtil.intervalToMs(this.interval),value:n.rangeUtil.intervalToMs(this.interval)}},this.getRangeScopedVars(Object(v.a)().timeRange())),r=Y.a.replace(e,t,this.interpolateQueryExpr),a=new g(this,r);return a.process()}},{key:"getRangeScopedVars",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(v.a)().timeRange(),t=e.to.diff(e.from),r=Math.round(t/1e3);return{__range_ms:{text:t,value:t},__range_s:{text:r,value:r},__range:{text:r+"s",value:r+"s"}}}},{key:"annotationQuery",value:(j=ee(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,u,s,l,c,f,p,m,h,d,v,y,g,b,O,w,x,j,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.annotation,u=i.expr,s=void 0===u?"":u,l=i.tagKeys,c=void 0===l?"":l,f=i.titleFormat,p=void 0===f?"":f,m=i.textFormat,h=void 0===m?"":m,s){e.next=4;break}return e.abrupt("return",Promise.resolve([]));case 4:return d=this.getPrometheusTime(t.range.from,!1),v=this.getPrometheusTime(t.range.to,!0),y=this.createAnnotationQueryOptions(t),g={expr:s,interval:"1s",refId:"X",requestId:"prom-query-".concat(i.name)},b=this.createQuery(g,y,d,v),O=this,e.next=13,this.performTimeSeriesQuery(b,b.start,b.end).toPromise();case 13:if(w=e.sent,x=[],j=c.split(","),!w.cancelled){e.next=18;break}return e.abrupt("return",[]);case 18:return k=1e3*Math.floor(null!==(r=b.step)&&void 0!==r?r:15),null==w||null===(n=w.data)||void 0===n||null===(a=n.data)||void 0===a||null===(o=a.result)||void 0===o||o.forEach((function(e){var t=Object.entries(e.metric).filter((function(e){var t=re(e,1)[0];return j.includes(t)})).map((function(e){var t=re(e,2);return t[0],t[1]}));e.values.forEach((function(e){var t;i.useValueForTime?(t=Math.floor(parseFloat(e[1])),e[1]=1):t=1e3*Math.floor(parseFloat(e[0])),e[0]=t}));var r=e.values.filter((function(e){return parseFloat(e[1])>=1})).map((function(e){return e[0]})),n=null,a=!0,o=!1,u=void 0;try{for(var s,l=r[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c,f=s.value;n&&(null!==(c=n.timeEnd)&&void 0!==c?c:0)+k>=f?n.timeEnd=f:(n&&x.push(n),n={time:f,timeEnd:f,annotation:i,title:O.resultTransformer.renderTemplate(p,e.metric),tags:t,text:O.resultTransformer.renderTemplate(h,e.metric)})}}catch(e){o=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}n&&(n.timeEnd=r[r.length-1],x.push(n))})),e.abrupt("return",x);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"getTagKeys",value:(w=ee(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.metadataRequest("/api/v1/labels");case 2:return a=e.sent,e.abrupt("return",null!==(t=null==a?void 0:null===(r=a.data)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.map((function(e){return{text:e}})))&&void 0!==t?t:[]);case 4:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"getTagValues",value:(O=ee(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,this.metadataRequest("/api/v1/label/".concat(a.key,"/values"));case 3:return o=e.sent,e.abrupt("return",null!==(t=null==o?void 0:null===(r=o.data)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.map((function(e){return{text:e}})))&&void 0!==t?t:[]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"testDatasource",value:(b=ee(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new Date).getTime(),r={expr:"1+1"},e.next=4,this.performInstantQuery(r,t/1e3).toPromise();case 4:return n=e.sent,e.abrupt("return","success"===n.data.status?{status:"success",message:"Data source is working"}:{status:"error",message:n.error});case 6:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"interpolateVariablesInQueries",value:function(e,t){var r=this,n=e;return e&&e.length&&(n=e.map((function(e){return ae({},e,{datasource:r.name,expr:Y.a.replace(e.expr,t,r.interpolateQueryExpr)})}))),n}},{key:"getQueryHints",value:function(e,t){var r;return z(null!==(r=e.expr)&&void 0!==r?r:"",t,this)}},{key:"loadRules",value:(y=ee(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.metadataRequest("/api/v1/rules");case 3:n=e.sent,(a=null===(t=n.data)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.groups)&&(this.ruleMappings=fe(a)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Rules API is experimental. Ignore next error."),console.error(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return y.apply(this,arguments)})},{key:"modifyQuery",value:function(e,t){var r,n=null!==(r=e.expr)&&void 0!==r?r:"";switch(t.type){case"ADD_FILTER":n=Object(G.b)(n,t.key,t.value);break;case"ADD_FILTER_OUT":n=Object(G.b)(n,t.key,t.value,"!=");break;case"ADD_HISTOGRAM_QUANTILE":n="histogram_quantile(0.95, sum(rate(".concat(n,"[5m])) by (le))");break;case"ADD_RATE":n="rate(".concat(n,"[5m])");break;case"ADD_SUM":n="sum(".concat(n.trim(),") by ($1)");break;case"EXPAND_RULES":t.mapping&&(n=Object(E.a)(n,t.mapping))}return ae({},e,{expr:n})}},{key:"getPrometheusTime",value:function(e,t){return"string"==typeof e&&(e=n.dateMath.parse(e,t)),Math.ceil(e.valueOf()/1e3)}},{key:"getTimeRange",value:function(){var e=Object(v.a)().timeRange();return{start:this.getPrometheusTime(e.from,!1),end:this.getPrometheusTime(e.to,!0)}}},{key:"getOriginalMetricName",value:function(e){return this.resultTransformer.getOriginalMetricName(e)}}])&&ie(r.prototype,a),d&&ie(r,d),t}(n.DataSourceApi);function fe(e){return e.reduce((function(e,t){return t.rules.filter((function(e){return"recording"===e.type})).reduce((function(e,t){return ae({},e,oe({},t.name,t.query))}),e)}),{})}function pe(e){return"string"==typeof e?e.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):e}function me(e){return"string"==typeof e?e.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):e}var he=r("q1tI"),de=r.n(he),ve=r("kDLi"),ye=r("wZee"),ge=r.n(ye),be=r("sGFA");function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Te(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Se="__histograms__";function Re(e,t){var r=t.typeaheadContext,n=t.typeaheadText;switch(r){case"context-labels":var a=ve.DOMUtil.getNextCharacter();a&&"}"!==a&&","!==a||(e+="=");break;case"context-label-values":n.match(/^(!?=~?"|")/)||(e='"'.concat(e)),'"'!==ve.DOMUtil.getNextCharacter()&&(e="".concat(e,'"'))}return e}var Ce=function(e){function t(e,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Pe(this,_e(t).call(this,e,r))).refreshHint=function(){var e=a.props,t=e.datasource,r=e.query,o=e.data;if(o&&0!==o.series.length){var i=Object(n.isDataFrame)(o.series[0])?o.series.map(n.toLegacyResponseData):o.series,u=t.getQueryHints(r,i),s=u.length>0?u[0]:null;a.setState({hint:s})}else a.setState({hint:null})},a.refreshMetrics=function(){var e=a.props.datasource.languageProvider;a.setState({syntaxLoaded:!1}),ge.a.languages.promql=e.syntax,a.languageProviderInitializationPromise=Object(be.a)(e.start()),a.languageProviderInitializationPromise.promise.then((function(e){e.map((function(e){return e.then(a.onUpdateLanguage).catch((function(){}))}))})).then((function(){return a.onUpdateLanguage()})).catch((function(e){if(!e.isCanceled)throw e}))},a.onChangeMetrics=function(e,t){var r;if(1===t.length){var n=t[0];if(n.children&&0!==n.children.length)return;r=n.value}else{var o=t[0].value,i=t[1].value;r=o===Se?"histogram_quantile(0.95, sum(rate(".concat(i,"[5m])) by (le))"):i}a.onChangeQuery(r,!0)},a.onChangeQuery=function(e,t){var r=a.props,n=r.query,o=r.onChange,i=r.onRunQuery;o&&(o(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){je(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n,{expr:e})),t&&i&&i())},a.onClickHintFix=function(){var e=a.props,t=e.datasource,r=e.query,n=e.onChange,o=e.onRunQuery,i=a.state.hint;n(t.modifyQuery(r,i.fix.action)),o()},a.onUpdateLanguage=function(){var e=a.props,t=e.datasource,r=e.datasource.languageProvider,n=r.histogramMetrics,o=r.metrics,i=r.metricsMetadata,u=r.lookupMetricsThreshold;if(o){var s=function(e,t){var r=/:\w+:/,n=e.filter((function(e){return r.test(e)})),a={label:"Recording rules",value:"__recording_rules__",children:n.slice().sort().map((function(e){return{label:e,value:e}}))},o=n.length>0?[a]:[],i=d.a.chain(e).filter((function(e){return!r.test(e)})).groupBy((function(e){return e.split("_")[0]})).map((function(e,r){return{children:1===e.length&&e[0]===r?[]:e.sort().map((function(e){return function(e,t){var r={label:e,value:e};if(t&&t[e]){var n=t[e][0],a=n.type,o=void 0===a?"":a,i=n.help;r.title=[e,o.toUpperCase(),i].join("\n")}return r}(e,t)})),label:r,value:r}})).sortBy("label").value();return[].concat(o,Te(i))}(o,i),l=n.map((function(e){return{label:e,value:e}})),c=n.length>0?[{label:"Histograms",value:Se,children:l,isLeaf:!1}].concat(Te(s)):s,f=null;!t.lookupsDisabled&&r.lookupsDisabled&&(f={label:"Dynamic label lookup is disabled for datasources with more than ".concat(u," metrics."),type:"INFO"}),a.setState({hint:f,metricsOptions:c,syntaxLoaded:!0})}},a.onTypeahead=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.props.datasource.languageProvider){e.next=3;break}return e.abrupt("return",{suggestions:[]});case 3:return n=a.props.history,o=t.prefix,i=t.text,u=t.value,s=t.wrapperClasses,l=t.labelKey,e.next=7,r.provideCompletionItems({text:i,value:u,prefix:o,wrapperClasses:s,labelKey:l},{history:n});case 7:return c=e.sent,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){we(o,n,a,i,u,"next",e)}function u(e){we(o,n,a,i,u,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),a.plugins=[Object(ve.BracesPlugin)(),Object(ve.SlatePrism)({onlyIn:function(e){return"code_block"===e.type},getSyntax:function(e){return"promql"}})],a.state={metricsOptions:[],syntaxLoaded:!1,hint:null},a}var r,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,e),r=t,(a=[{key:"componentDidMount",value:function(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}},{key:"componentWillUnmount",value:function(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.data;t.datasource.languageProvider!==e.datasource.languageProvider&&this.refreshMetrics(),r&&e.data&&e.data.series!==r.series&&this.refreshHint()}},{key:"render",value:function(){var e,t,r,n=this.props,a=n.datasource,o=n.datasource.languageProvider,i=n.query,u=n.ExtraFieldElement,s=this.state,l=s.metricsOptions,c=s.syntaxLoaded,f=s.hint,p=o?o.cleanText:void 0,m=(e=a.lookupsDisabled,t=c,r=l,e?"(Disabled)":t?r&&0===r.length?"(No metrics found)":"Metrics":"Loading metrics..."),h=!(c&&l&&l.length>0);return de.a.createElement(de.a.Fragment,null,de.a.createElement("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1"},de.a.createElement("div",{className:"gf-form flex-shrink-0"},de.a.createElement(ve.ButtonCascader,{options:l,disabled:h,onChange:this.onChangeMetrics},m)),de.a.createElement("div",{className:"gf-form gf-form--grow flex-shrink-1 min-width-15 explore-input-margin"},de.a.createElement(ve.QueryField,{additionalPlugins:this.plugins,cleanText:p,query:i.expr,onTypeahead:this.onTypeahead,onWillApplySuggestion:Re,onBlur:this.props.onBlur,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,placeholder:"Enter a PromQL query (run with Shift+Enter)",portalOrigin:"prometheus",syntaxLoaded:c})),u),f?de.a.createElement("div",{className:"query-row-break"},de.a.createElement("div",{className:"prom-query-field-info text-warning"},f.label," ",f.fix?de.a.createElement("a",{className:"text-link muted",onClick:this.onClickHintFix},f.fix.label):null)):null)}}])&&ke(r.prototype,a),o&&ke(r,o),t}(de.a.PureComponent);function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function Ie(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){De(o,n,a,i,u,"next",e)}function u(e){De(o,n,a,i,u,"throw",e)}i(void 0)}))}}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e,t){return!t||"object"!==qe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ne=function(e){function t(){var e,r;Me(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Qe(this,(e=Fe(t)).call.apply(e,[this].concat(a)))).state={href:""},r}var r,n,a,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,e),r=t,(n=[{key:"componentDidUpdate",value:(i=Ie(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.props.panelData)||!r.request||t.panelData===r){e.next=6;break}return e.next=4,this.getExternalLink(r);case 4:n=e.sent,this.setState({href:n});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getExternalLink",value:(o=Ie(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,u,s,l,c,f,p,m,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props,n=r.query,a=r.datasource,o=t.request){e.next=4;break}return e.abrupt("return","");case 4:return i=o.range,u=a.getPrometheusTime(i.from,!1),s=a.getPrometheusTime(i.to,!0),l=Math.ceil(s-u),c=i.to.utc().format("YYYY-MM-DD HH:mm"),f={interval:o.interval},p=a.createQuery(n,f,u,s),m={"g0.expr":p.expr,"g0.range_input":l+"s","g0.end_input":c,"g0.step_input":p.step,"g0.tab":0},h=d.a.map(m,(function(e,t){return t+"="+encodeURIComponent(e)})).join("&"),e.abrupt("return","".concat(a.directUrl,"/graph?").concat(h));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"render",value:function(){var e=this.state.href;return de.a.createElement("a",{href:e,target:"_blank",rel:"noopener"},"Prometheus")}}])&&Le(r.prototype,n),a&&Le(r,a),t}(he.Component);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e,t){return($e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ge=ve.LegacyForms.Switch,Ke=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"},{label:"Heatmap",value:"heatmap"}],We=d.a.map([1,2,3,4,5,10],(function(e){return{value:e,label:"1/"+e}})),ze=function(e){function t(e){var r,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=He(t).call(this,e),(r=!a||"object"!==Ue(a)&&"function"!=typeof a?Be(n):a).onFieldChange=function(e,t){r.query.expr=e.expr},r.onFormatChange=function(e){r.query.format=e.value,r.setState({formatOption:e},r.onRunQuery)},r.onInstantChange=function(e){var t=e.target.checked;r.query.instant=t,r.setState({instant:t},r.onRunQuery)},r.onIntervalChange=function(e){var t=e.currentTarget.value;r.query.interval=t,r.setState({interval:t})},r.onIntervalFactorChange=function(e){r.query.intervalFactor=e.value,r.setState({intervalFactorOption:e},r.onRunQuery)},r.onLegendChange=function(e){var t=e.currentTarget.value;r.query.legendFormat=t,r.setState({legendFormat:t})},r.onRunQuery=function(){var e=Be(r).query;r.props.onChange(e),r.props.onRunQuery()};var o=Object.assign({},{expr:"",legendFormat:"",interval:""},e.query);return r.query=o,r.state={interval:o.interval,legendFormat:o.legendFormat,formatOption:Ke.find((function(e){return e.value===o.format}))||Ke[0],intervalFactorOption:We.find((function(e){return e.value===o.intervalFactor}))||We[0],instant:Boolean(o.instant)},r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.datasource,r=e.query,n=e.data,a=this.state,o=a.formatOption,i=a.instant,u=a.interval,s=a.intervalFactorOption,l=a.legendFormat;return de.a.createElement("div",null,de.a.createElement(Ce,{datasource:t,query:r,onRunQuery:this.onRunQuery,onChange:this.onFieldChange,history:[],data:n}),de.a.createElement("div",{className:"gf-form-inline"},de.a.createElement("div",{className:"gf-form"},de.a.createElement(ve.InlineFormLabel,{width:7,tooltip:"Controls the name of the time series, using name or pattern. For example {{hostname}} will be replaced with label value for the label hostname."},"Legend"),de.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"legend format",value:l,onChange:this.onLegendChange,onBlur:this.onRunQuery})),de.a.createElement("div",{className:"gf-form"},de.a.createElement(ve.InlineFormLabel,{width:7,tooltip:de.a.createElement(de.a.Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",de.a.createElement("code",null,"$__interval")," and ",de.a.createElement("code",null,"$__rate_interval"),' variables. The limit is absolute and not modified by the "Resolution" setting.')},"Min step"),de.a.createElement("input",{type:"text",className:"gf-form-input width-8",placeholder:u,onChange:this.onIntervalChange,onBlur:this.onRunQuery,value:u})),de.a.createElement("div",{className:"gf-form"},de.a.createElement("div",{className:"gf-form-label"},"Resolution"),de.a.createElement(ve.Select,{isSearchable:!1,menuPlacement:"bottom",options:We,onChange:this.onIntervalFactorChange,value:s})),de.a.createElement("div",{className:"gf-form"},de.a.createElement("div",{className:"gf-form-label width-7"},"Format"),de.a.createElement(ve.Select,{width:16,isSearchable:!1,options:Ke,onChange:this.onFormatChange,value:o}),de.a.createElement(Ge,{label:"Instant",checked:i,onChange:this.onInstantChange}),de.a.createElement(ve.InlineFormLabel,{width:10,tooltip:"Link to Graph in Prometheus"},de.a.createElement(Ne,{datasource:t,query:this.query,panelData:n})))))}}])&&Ve(r.prototype,n),a&&Ve(r,a),t}(he.PureComponent),Xe=[{title:"Request Rate",expression:"rate(http_request_total[5m])",label:"Given an HTTP request counter, this query calculates the per-second average request rate over the last 5 minutes."},{title:"95th Percentile of Request Latencies",expression:"histogram_quantile(0.95, sum(rate(prometheus_http_request_duration_seconds_bucket[5m])) by (le))",label:"Calculates the 95th percentile of HTTP request rate over 5 minute windows."},{title:"Alerts Firing",expression:'sort_desc(sum(sum_over_time(ALERTS{alertstate="firing"}[24h])) by (alertname))',label:"Sums up the alerts that have been firing over the last 24 hours."},{title:"Step",label:"Defines the graph resolution using a duration format (15s, 1m, 3h, ...). Small steps create high-resolution graphs but can be slow over larger time ranges. Using a longer step lowers the resolution and smooths the graph by producing fewer datapoints. If no step is given the resolution is calculated automatically."}];function Ye(e){var t=e.label,r=e.onChangeFunc,n=e.onKeyDownFunc,a=e.value,o=e.hasTooltip,i=e.tooltipContent;return de.a.createElement("div",{className:"gf-form-inline","aria-label":"Prometheus extra field"},de.a.createElement("div",{className:"gf-form"},de.a.createElement(ve.InlineFormLabel,{width:5,tooltip:o?i:void 0},t),de.a.createElement("input",{type:"text",className:"gf-form-input width-4",placeholder:"auto",onChange:r,onKeyDown:n,value:a})))}Object(he.memo)(Ye);function Je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ze(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var et=Object(he.memo)((function(e){var t=e.query,r=e.data,n=e.datasource,a=e.history,o=e.onChange,i=e.onRunQuery;function u(t){var r=e.query;(0,e.onChange)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach((function(t){Ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{interval:t}))}return de.a.createElement(Ce,{datasource:n,query:t,onRunQuery:i,onChange:o,onBlur:function(){},history:a,data:r,ExtraFieldElement:de.a.createElement(Ye,{label:"Step",onChangeFunc:function(e){e.currentTarget.value!==t.interval&&u(e.currentTarget.value)},onKeyDownFunc:function(e){"Enter"===e.key&&i()},value:t.interval||"",hasTooltip:!0,tooltipContent:"Time units can be used here, for example: 5s, 1m, 3h, 1d, 1y (Default if no unit is specified: s)"})})}));function tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(r),!0).forEach((function(t){nt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function nt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var at=ve.LegacyForms.Select,ot=ve.LegacyForms.Input,it=ve.LegacyForms.FormField,ut=ve.LegacyForms.Switch,st=[{value:"GET",label:"GET"},{value:"POST",label:"POST"}],lt=function(e){var t,r=e.options,a=e.onOptionsChange;return de.a.createElement(de.a.Fragment,null,de.a.createElement("div",{className:"gf-form-group"},de.a.createElement("div",{className:"gf-form-inline"},de.a.createElement("div",{className:"gf-form"},de.a.createElement(it,{label:"Scrape interval",labelWidth:13,inputEl:de.a.createElement(ot,{className:"width-6",value:r.jsonData.timeInterval,spellCheck:!1,placeholder:"15s",onChange:pt("timeInterval",r,a),validationEvents:ct}),tooltip:"Set this to the typical scrape and evaluation interval configured in Prometheus. Defaults to 15s."}))),de.a.createElement("div",{className:"gf-form-inline"},de.a.createElement("div",{className:"gf-form"},de.a.createElement(it,{label:"Query timeout",labelWidth:13,inputEl:de.a.createElement(ot,{className:"width-6",value:r.jsonData.queryTimeout,onChange:pt("queryTimeout",r,a),spellCheck:!1,placeholder:"60s",validationEvents:ct}),tooltip:"Set the Prometheus query timeout."}))),de.a.createElement("div",{className:"gf-form"},de.a.createElement(ve.InlineFormLabel,{width:13,tooltip:"Specify the HTTP Method to query Prometheus. (POST is only available in Prometheus >= v2.1.0)"},"HTTP Method"),de.a.createElement(at,{options:st,value:st.find((function(e){return e.value===r.jsonData.httpMethod})),onChange:pt("httpMethod",r,a),width:7}))),de.a.createElement("h3",{className:"page-heading"},"Misc"),de.a.createElement("div",{className:"gf-form-group"},de.a.createElement("div",{className:"gf-form"},de.a.createElement(ut,{checked:null!==(t=r.jsonData.disableMetricsLookup)&&void 0!==t&&t,label:"Disable metrics lookup",labelClass:"width-14",onChange:Object(n.onUpdateDatasourceJsonDataOptionChecked)(e,"disableMetricsLookup"),tooltip:"Checking this option will disable the metrics chooser and metric/label support in the query field's autocomplete. This helps if you have performance issues with bigger Prometheus instances."})),de.a.createElement("div",{className:"gf-form-inline"},de.a.createElement("div",{className:"gf-form max-width-30"},de.a.createElement(it,{label:"Custom query parameters",labelWidth:14,tooltip:"Add Custom parameters to Prometheus or Thanos queries.",inputEl:de.a.createElement(ot,{className:"width-25",value:r.jsonData.customQueryParameters,onChange:pt("customQueryParameters",r,a),spellCheck:!1,placeholder:"Example: max_source_resolution=5m&timeout=10"})})))))},ct=nt({},ve.EventsWithValidation.onBlur,[Object(ve.regexValidation)(/^$|^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")]),ft=function(e){return e?e.hasOwnProperty("currentTarget")?e.currentTarget.value:e.value:""},pt=function(e,t,r){return function(n){r(rt({},t,{jsonData:rt({},t.jsonData,nt({},e,ft(n)))}))}};r.d(t,"plugin",(function(){return ht}));var mt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stepDefaultValuePlaceholder="60s"};mt.templateUrl="partials/annotations.editor.html";var ht=new n.DataSourcePlugin(ce).setQueryEditor(ze).setConfigEditor((function(e){var t=e.options,r=e.onOptionsChange;return de.a.createElement(de.a.Fragment,null,de.a.createElement(ve.DataSourceHttpSettings,{defaultUrl:"http://localhost:9090",dataSourceConfig:t,showAccessOptions:!0,onChange:r}),de.a.createElement(lt,{options:t,onOptionsChange:r}))})).setExploreMetricsQueryField(et).setAnnotationQueryCtrl(mt).setExploreStartPage((function(e){return de.a.createElement("div",null,de.a.createElement("h2",null,"PromQL Cheat Sheet"),Xe.map((function(t,r){return de.a.createElement("div",{className:"cheat-sheet-item",key:r},de.a.createElement("div",{className:"cheat-sheet-item__title"},t.title),t.expression?de.a.createElement("div",{className:"cheat-sheet-item__example",onClick:function(r){return e.onClickExample({refId:"A",expr:t.expression})}},de.a.createElement("code",null,t.expression)):null,de.a.createElement("div",{className:"cheat-sheet-item__label"},t.label))})))}))},sGFA:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){var t=!1;return{promise:new Promise((function(r,n){e.then((function(e){return t?n({isCanceled:!0}):r(e)})),e.catch((function(e){return n(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}}}}]);
//# sourceMappingURL=prometheusPlugin.4e20f99bf66682942589.js.map