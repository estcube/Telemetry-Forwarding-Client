(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"8DhQ":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"LiveAdmin",(function(){return g}));var r=n("q1tI"),o=n.n(r),a=n("0cfB"),i=n("/MKj"),c=n("lzJ5"),u=n("ZGyg"),l=n("Obii"),s=n("Be0a"),f=n("kDLi"),p=n("t8hP");function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){var e,n;h(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=y(this,(e=v(t)).call.apply(e,[this].concat(o)))).state={channel:"random-2s-stream",text:""},n.onChannelChanged=function(e){e.value&&n.setState({channel:e.value})},n.onTextChanged=function(e){n.setState({text:e.target.value})},n.onPublish=function(){var e=n.state,t=e.text,r=e.channel;if(t){var o={line:t};Object(p.getGrafanaLiveSrv)().publish(r,o).then((function(e){console.log("PUBLISHED",t,e)}))}n.setState({text:""})},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.navModel,t=this.state,n=t.channel,r=t.text,a=[{label:"random-2s-stream",value:"random-2s-stream",description:"Random stream that updates every 2s"},{label:"random-flakey-stream",value:"random-flakey-stream",description:"Random stream with intermittent updates"},{label:"example-chat",value:"example-chat",description:"A channel that expects chat messages"}],i=a.find((function(e){return e.value===n}));return i||(i={label:n,value:n},a.push(i)),o.a.createElement(u.a,{navModel:e},o.a.createElement(u.a.Contents,null,o.a.createElement(f.Container,{grow:1},o.a.createElement(f.FeatureInfoBox,{title:"Grafana Live",featureState:l.FeatureState.alpha},o.a.createElement("p",null,"This supports real-time event streams in grafana core. This feature is under heavy development. Expect the intefaces and structures to change as this becomes more production ready.")),o.a.createElement("br",null),o.a.createElement("br",null)),o.a.createElement("h2",null,"Channels"),o.a.createElement(f.Select,{options:a,value:i,onChange:this.onChannelChanged,allowCustomValue:!0}),o.a.createElement("br",null),o.a.createElement(s.a,{channel:n}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("h3",null,"Write to channel"),o.a.createElement(f.Input,{value:r,onChange:this.onTextChanged}),o.a.createElement(f.Button,{onClick:this.onPublish,variant:r?"primary":"secondary"},"Publish")))}}])&&m(n.prototype,r),a&&m(n,a),t}(r.PureComponent);t.default=Object(a.hot)(e)(Object(i.connect)((function(e){return{navModel:Object(c.a)(e.navIndex,"live")}}))(g))}.call(this,n("3UD+")(e))},Be0a:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("q1tI"),o=n.n(r),a=n("t8hP");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=l(this,(e=s(t)).call.apply(e,[this].concat(o)))).state={connected:!1,count:0,lastTime:0,lastBody:""},n.observer={next:function(e){n.setState({count:n.state.count+1,lastTime:Date.now(),lastBody:JSON.stringify(e)})}},n.startSubscription=function(){n.subscription&&(n.subscription.unsubscribe(),n.subscription=void 0);var e=Object(a.getGrafanaLiveSrv)();if(e.isConnected()){var t=e.getChannelStream(n.props.channel);return n.subscription=t.subscribe(n.observer),void n.setState({connected:!0,count:0,lastTime:0,lastBody:""})}console.log("Not yet connected... try again..."),setTimeout(n.startSubscription,200)},n.componentDidMount=function(){n.startSubscription()},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(r=[{key:"componentWillUnmount",value:function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0)}},{key:"componentDidUpdate",value:function(e){e.channel!==this.props.channel&&this.startSubscription()}},{key:"render",value:function(){var e=this.state,t=e.lastBody,n=e.lastTime,r=e.count;return o.a.createElement("div",null,o.a.createElement("h5",null,"Count: ",r),n>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("h5",null,"Last: ",n),t&&o.a.createElement("div",null,o.a.createElement("pre",null,t))))}}])&&u(n.prototype,r),i&&u(n,i),t}(r.PureComponent)}}]);
//# sourceMappingURL=LiveAdmin.4e20f99bf66682942589.js.map